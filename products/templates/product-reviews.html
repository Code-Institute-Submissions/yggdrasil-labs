{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="card">
	<div class="card-header">
		<h4 class="text-uppercase text-center">{{ product.name }} reviews</h4>
	</div>
	<div class="card-body">
		{% for review in reviews %}
		{% if review.user_profile.user == request.user %}
		<div class="row mb-3 review-form__wrapper" id="currentUserReview">
			<div class="col-10 offset-1">
				<p>Your review <i class="far fa-edit" id="editReview"></i></p>
			</div>
			<form action="{% url 'product_reviews' product.id %}" method="POST">
				<div class="col-10 offset-1">
					{% csrf_token %}
					{{ form|crispy }}
				</div>
				<div class="col-3 offset-8 text-right d-none">
					<button class="btn button-primary button__small" id="reviewSubmitButton">Submit</button>
				</div>
			</form>
		</div>
		{% else %}
		<div class="row mb-4 review__wrapper">
			<div class="col-10 offset-1 review-body__shadow">
				{% if review.user_profile.default_full_name|length > 0 %}
				<p>{{ review.user_profile.default_full_name|capfirst }} -</p>
				{% else %}
				<p>{{ review.user_profile|capfirst }} -</p>
				{% endif %}
				<p class="font-italic">"{{ review.review_content }}"</p>
			</div>
		</div>
		{% endif %}
		{% endfor %}
		{% if user_review == "" %}
		<div class="row review-form__wrapper" id="newUserReview">
			<div class="col-10 offset-1">
				<p>Create a review <i class="far fa-edit" id="editReview"></i></p>
			</div>
			<form action="{% url 'product_reviews' product.id %}" method="POST" class="d-none">
				<div class="col-10 offset-1">
					{% csrf_token %}
					{{ form|crispy }}
				</div>
				<div class="col-3 offset-8 text-right">
					<button class="btn button-primary button__small" id="reviewSubmitButton">Submit</button>
				</div>
			</form>
		</div>
		{% endif %}
		<div class="row mt-5">
			<div class="col-6 col-md-3 offset-md-1">
				<a href="{% url 'product_detail' product.id %}"><button
						class="btn button-primary-outline ">Back</button></a>
			</div>
			<div class="col-6 col-md-3 offset-md-4 text-right">
				<a href=""></a><button class="btn button-secondary-outline">Buy</button></a>
			</div>
		</div>
	</div>
</div>
{% endblock content %}
{% block extra_scripts %}
<script src="{% static 'products/js/scripts.js' %}"></script>
{% endblock extra_scripts %}
