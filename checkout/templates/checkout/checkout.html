{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="card">
	<div class="card-header">
		<h3>Checkout</h3>
	</div>
	<div class="card-body">
		<form action="{% url 'checkout' %}" method="POST">
			{% csrf_token %}
			{{ form|crispy }}
			<fieldset>
				<legend>Payment Info</legend>
				<div id="cardElement"></div>
				<div id="cardErrors" role="alert"></div>
				<input type="hidden" name="client_secret" value="{{  client_secret }}">
			</fieldset>
			<button class="btn button-primary-outline button__small col-6 float-right" name="{{ form.prefix }}"
				type="submit">Checkout</button>
			<div class="">
				{% if form.errors %}
				{% for field in form %}
				{% for error in field.errors %}
				<div class="alert alert-danger">
					<strong>{{ error|escape }}</strong>
				</div>
				{% endfor %}
				{% endfor %}
				{% for error in form.non_field_errors %}
				<div class="alert alert-danger">
					<strong>{{ error|escape }}</strong>
				</div>
				{% endfor %}
				{% endif %}
			</div>
		</form>
	</div>
</div>
{% endblock content %}
{% block extra_scripts %}
{{ stripe_public_key|json_script:"id_stripe_public_key"}}
{{ client_secret|json_script:"id_client_secret"}}
<script src="{% static 'checkout/js/scripts.js' %}"></script>
{% endblock extra_scripts %}
